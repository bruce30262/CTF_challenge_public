#include <stdio.h>
#include <string.h>
#include <math.h>
#include <stdlib.h>
#include <unistd.h>
#include <stdint.h>

unsigned char check1[] = "\x1f\x4b\x3c\x6b\x02\x80\x59\xee\x02\x8a\xc8\x26\xc3\x76\x11\xea\x02\x88\xb1\xab\x62\x03\xb5\x8e\x02\x8a\xf0\x76\x7b\xc3\x72\xcb\x8a\x47\xc0\xc3\x28\xc5\xf0\x4a\x4a\x4b\x72\xcb\x9a\x03\xb5\x8e\x4a\x4b\x72\xcb\x92\x03\xb5\x8e\x4a\x4b\x72\xcb\xaa\x03\xb5\x8e\x4a\xc4\xf0\x66\x4a\x03\xb5\x8e\x2c\xc4\xf0\x62\x4a\x03\xfd\x36\x03\x25\xc7\xbb\x3c\x32\xa6\x8a\x02\x8a\xf0\x4b\x2c\xc4\xf0\x43\x04\x5d\x73\xcb\x85\x03\x72\xcb\xf2\x03\xb5\x8e\x4a\xc4\xf0\x32\x4b\x03\xb5\x8e\x8d\x46\x0d\x8e\x4a\x03\xb5\x65\x73\x88\xf0\x36\x02\x60\x65\xc6\xc1\x46\x1d\xc6\x4b\xd3\xba\x38\x42\x88\xf0\x36\xd3\xc2\x5f\x90\x4b\xd3\x36\x6e\x49\x2a\x65\xc6\xd2\x0c\x03\xca\x4f\xc3\x36\x66\x4d\x32\x74\x07\x80\x88\xf0\x36\x02\x9b\x3d\xda\x4f\xd3\x36\xcb\xf2\x02\x3e\xcb\xf2\x38\xf0\x2a\x36\xbc\x72\xcb\xf2\x03\xb5\x8e\x4a\xe8\x96\x05\x0f\xbb\xfd\x16\x45\xb5\xe1\x8b\x9a\x88\xf0\x36\x02\x9b\xba\x38\x0e\x06\x70\xb6\x88\x77\xb2\x49\x0f\xbf\xb5\x8e\x4a\x03\x36\xcb\xf2\x02\x3e\xcb\xf2\x38\xf0\x2a\x36\xd6\x3e\xcb\xf6\x4b\x3e\xfb\xb2\x67\xfd\xbd\x7e\x26\x9d\x8e\x4a\x03\xc1\x8b\xa2\xb7\x49\x71\xb5\xca\x76";
unsigned char check2[] = "\x11\x92\x76\x23\x0c\x59\x13\xb6\x0c\x53\x82\x5e\x20\x92\x74\xc2\x61\xf2\xff\xc6\x44\x92\x76\x83\xbc\xeb\x3f\x01\x01\x7e\xff\xc6\x44\xda\x38\x83\xec\xda\xff\xc6\x44\x1d\xba\x6a\x44\xda\xff\xc6\x83\x9f\x4f\xc7\x44\xda\xff\x01\x01\x0a\x42\x4b\x8f\x4f\x38\x83\x90\xa3\x33\x42\x4b\x1d\xba\x1e\x32\x72\x66\x7e\x83\x9f\x23\x93\xef\x87\xf5\x01\x01\x3a\x45\xfd\xcf\x40\x38\x83\xa0\x7d\xc7\x74\x34\x1d\xba\x2e\xb5\xe6\x4a\xb4\x83\x9f\x13\xcf\x46\xa6\x2b\x01\x01\x76\xff\xc6\x44\xda\x16\xd5\x45\xda\xff\x4d\x01\x76\xb7\xa5\x94\x92\x74\x83\xdc\x92\xfe\x16\x4b\x6c\xff\xc9\xfa\x1a\xda\x39\x44\xda\xff\x4f\x01\x7e\x74\x83\xe8\x92\x67\x8e\xc9\x8a\xfb\x8e\xcf\x9f\x67\x8e\x45\x0a\xf0\x70\x44\xd5\x41\x06\x61\x25\xff\xc6\x44\x53\xba\x6e\x83\x9f\x4b\xc6\x44\xda\xff\x01\x01\x66\x52\x18\x73\xc9\x38\x83\x84\x99\xff\xc6\x44\x1d\xba\x02\x74\xda\xff\xc6\x83\x9f\x37\x94\x44\xda\xff\x01\x01\x16\xcc\xc6\x44\xda\x38\x83\xfc\xda\xff\xc6\x44\x1d\xba\x7e\x44\xda\xff\xc6\xaf\xbf\x74\x83\xec\x1b\x1f\xc2\xcd\x18\x74\x83\xec\x1b\x17\xc3\x75\x18\x74\x83\xec\x57\xf3\xc4\xcf\x9f\x4b\x45\xa4\xd9\x76\x06\xcf\x8e\x7a\x06\xcf\x9f\x4b\xc7\x94\xeb\x37\xc7\x01\x7e\x74\x83\xf8\xdb\xba\x72\xcf\x9f\x5b\x07\xa4\xde\x76\x04\xcf\x9f\x5b\x07\xac\xdf\xce\x04\xcf\x9f\x5b\x4b\x48\xd8\x74\x83\xf0\x1b\x17\xcd\xc7\x3a\xfc\x4f\x84\x51\xab\x43\x84\x51\xba\x72\x45\x0a\xce\x0e\x45\x9f\x57\x45\x01\x62\xfe\x45\x39\x62\xe0\xb8\xd1\x51\xba\x6a\x45\x1a\xb7\x5e\xcf\x9e\x7a\x16\x7d\x9f\x5b\xb2\x43\x1d\xba\x76\x44\xda\xff\xc6\xcf\x9f\x53\xc7\x84\x59\x3f\xc7\x0c\x42\x74\x82\xc1\x0a\xc6\x83\xec\xae\xf8\x01\x01\x6a\xff\xc6\x44\xda\x7c\x83\xe8\xdb\x7c\xbb\xe8\xd9\xf0\x48\xa7\x24\x00\x39\xcf\x9f\x4f\x8e\xcf\xaf\x07\xa2\x0c\xe9\xcb\xe3\x6c\xda\xff\xc6\x30\xdf\x17\x3b\xbe\x25\x00\x0f\x87";
unsigned char check3[] = "\xb4\x77\x63\x60\xa9\xbe\x06\x65\xe1\x3f\xea\xcd\x68\x82\xc2\x7a\x1e\xc0\x63\x30\xc5\xc0\x15\x7a\x85\x77\x61\x81\xc4\x17\xea\x85\xe1\x77\x63\xc0\x19\x0e\x2a\xcd\x26\xba\x9a\x7a\x1e\xc0\xea\x85\xe1\x3f\xa2\x42\x64\x47\x15\x7a\x1e\x3f\xea\x85\xe1\x77\x2d\xc0\x61\x3f\xea\x85\xe1\x77\x2d\xc0\x69\x3f\xea\x85\xe1\x77\x2d\xc0\x71\x3f\xea\x85\xe1\x77\x2d\xc0\x79\x3f\xea\x85\xe1\x59\x2d\xc0\x41\x3f\xea\xcd\x59\x15\x96\xa8\xa8\x59\x84\xf4\xd3\x77\x50\xb5\xc0\x1f\xe0\xc4\xbb\x5b\xce\xcd\x68\x7a\x5a\xcd\x68\x6a\x52\xcd\x59\x4d\xd6\xdd\x8e\x63\xae\xaa\x9a\x77\x50\xce\xa2\x41\x8b\xb1\xb5\x45\xdd\xcd\x68\x7a\x2a\xcd\x68\x6a\x22\xcd\x59\x16\xb3\xdb\xdb\x47\x8a\x8e\x9c\x77\x50\xd6\x92\x0e\x93\xca\x8c\x56\x9c\xcd\x68\x7a\x3a\xcd\x68\x6a\x32\xcd\x59\x1c\xe7\xa0\xbc\x7f\xb1\xda\xaf\x77\x50\xad\xa9\x55\xc6\xd3\xb0\x4a\x8d\xcd\x68\x7a\x0a\xcd\x68\x6a\x02\x43\xa4\xcf\xea\xcd\x59\x0b\x8a\xd4\xc4\x7e\xb5\xc4\xc2\x77\x50\xd1\xdb\x65\xcf\xc4\xce\x77\x97\xcd\x68\xba\xba\x7a\x1e\xc0\xa2\x0c\x74\x67\x15\x7a\x1e\x77\x52\xfe\xc4\x52\xb9\xc4\xba\x6e\xe1\xcd\x68\xba\x8a\x7a\x1e\xc0\x2c\x00\x89\xc0\x15\x7a\xe1\xf8\x6f\xb5\x1e\xc0\x15\x84\xe1\x3f\xea\x0e\x64\x1b\x15\x7a\x1e\x77\x89\x55\xa9\xb4\x6f\xad\x1e\xc0\x15\xcd\xe0\xef\xa2\x0c\x64\x77\x15\x7a\x1e\x77\x61\x00\xc9\xc0\x15\x7a\xa9\xb6\x6f\xc5\x1e\xc0\x15\xcd\x6c\xba\x9a\x7a\x1e\xc0\xa2\x0c\x64\x07\x15\x7a\x1e\xd6\x10\x85\xe1\x3f\xa2\x0e\x64\x7f\x15\x7a\x1e\x30\x5c\x85\x21\xd7\xe8\x8a\x57\xff\xa2\x1d\xee\x89\xa6\x80\x51\x77\x61\x00\xd9\xc0\x15\x7a\xa9\xb2\xba\x84\xa9\xb6\x7f\xbd\x1e\xc0\x15\x0c\x2b\xb7\xfa\xcd\x6a\xba\xaa\x7a\x1e\xc0\xe5\x33\xe1\x30\x5c\x45\x20\xdf\xee\x06\x01\x0f\x63\x47\xa9\xb4\x6f\xc5\x1e\xc0\x15\xcd\x62\xff\xeb\x8a\x57\x3f\x2a\x6d\xe5\x30\x5c\x45\xe8\xef\xa2\x1d\xee\x89\xa6\x80\x51\x77\x61\x00\xd9\xc0\x15\x7a\xa9\xb2\xba\x84\xa9\xb6\x7f\xbd\x1e\xc0\x15\x0c\x2b\xb7\xfa\xcd\x6a\xba\xaa\x7a\x1e\xc0\xa2\x06\x21\x3e\xe5\x33\xe1\x30\x5c\x45\x20\xdf\xe8\x06\x01\x03\x63\x47\xa9\xb4\x6f\xc5\x1e\xc0\x15\xcd\x62\xff\xe8\x8a\x57\x3f\x2a\x6d\xe7\x30\x5c\x45\xe8\xef\xa2\x1d\xee\x89\xa6\x80\x51\x77\x61\x00\xd9\xc0\x15\x7a\xa9\xb2\xba\x84\xa9\xb6\x7f\xbd\x1e\xc0\x15\x0c\x2b\xb7\xfa\xcd\x6a\xba\xaa\x7a\x1e\xc0\xa2\x06\x21\x3d\xe5\x33\xe1\x30\x5c\x45\x62\xdf\xd5\xcd\x79\x30\x5c\xc9\xe4\x8f\xa2\x0e\x64\x07\x15\x7a\x1e\x77\x67\xd5\xe0\x77\x63\x10\xd9\xc0\x15\x7a\x68\xf5\x62\x95\xa9\xbc\x6f\xc5\x1e\xc0\x15\x86\xa9\xb4\x7f\xcd\x1e\xc0\x15\xcd\x6a\xba\xaa\x7a\x1e\xc0\xa2\xac\x23\x77\x63\x55\xa9\xbc\x12\x87\xee\xb0\x02\x7b\x1e\xc0\x2d\x00\xd5\xc0\x15\x7a\xe1\x3f\xea\x85\x26\xba\xde\x7a\x1e\xc0\xea\x85\xe1\x3f\x01\xbe\x6a\xba\xde\x7a\x1e\xc0\xa2\x1d\xee\x89\x6e\x80\x91\xc0\x15\x7a\xee\x89\x3a\x0e\x64\x0b\x15\x7a\x1e\x77\x72\x8a\x57\xbb\xef\xd5\x1e\xc0\x15\x8a\x5f\xff\xd3\x47\x95\x35\x2d\x00\xd1\xc0\x15\x7a\xe1\x3f\xea\x85\x62\xba\xde\x7a\x1e\xc0\xeb\x06\x5c\x0b\x15\x7a\x1e\x28\x94\x39\x6a\xba\xda\x7a\x1e\xc0\xa2\x0e\x94\xc7\x8e\xcd\xd2\x0b\xcf\xad\xe1\x3f\xea\xf1\xe4\xd7\xf3\x7d\x1e\xc0\x23\x46";
unsigned char check4[] = "\xa7\xd6\x24\xa7\xba\x1f\x41\xe2\xf6\x9e\xad\x0a\x7b\x23\xc5\xb9\x0d\x61\x24\xf7\x96\x65\x52\xbd\x96\xd6\x26\x46\xd7\xb6\xad\x42\xf2\xd6\x24\x07\x0a\xaf\x6d\x0a\x7f\x0b\x3d\xb9\x0d\x61\x15\x42\xf2\x9e\xad\xfb\x8f\x9e\xad\x42\xba\x17\x7a\xb1\xba\x35\xe5\xfa\xa2\xf2\x9e\x23\x81\xc1\xc9\x72\xba\x24\xc3\x65\x86\xc1\xce\x10\xc6\xab\xe5\xcb\xb7\x0e\xe5\xcb\xa7\x06\xe5\xfa\x9a\xc1\x9c\x2c\xad\xb5\xc5\x63\xba\x24\xde\x1d\x94\xcb\xc3\x01\xd9\xaf\xe5\xcb\xb7\x3e\xe5\xcb\xa7\x36\xcb\x85\xb7\x2e\x9d\x2c\x34\xdb\x1f\x42\xba\x59\xe8\x82\xf2\x9e\xad\x42\xba\x59\xe8\x8a\xf2\x9e\xad\x42\xba\x59\xe8\x92\xf2\x9e\xad\x42\xba\x59\xe8\x9a\xf2\x9e\xad\x42\xba\x59\xe8\xa2\xf2\x9e\xad\x42\xba\x59\xe8\xaa\xf2\x9e\xad\x42\x94\x59\xe8\xb2\xf2\x9e\xe5\xfa\xd9\xcb\xf0\xd1\x52\xdd\x70\x56\xba\x17\xe8\xc1\x35\xdb\x26\x01\xa0\xe3\x48\x84\xb7\x11\xad\x85\x77\x1e\x56\xbd\x0d\xbc\xad\x42\xf2\x59\x28\x32\x09\x61\x52\x42\xf2\x9e\xad\x85\x77\xea\x56\xbd\x0d\x9e\xad\x42\xf2\x59\x28\x3a\x09\x61\x52\x43\xf2\x9e\xad\x85\x77\xee\x56\xbd\x0d\x9e\xad\x42\xf2\x75\xb1\xc9\x77\xee\x56\xbd\x0d\xd6\x35\xc9\x67\xee\x56\xbd\x0d\x17\x39\xc7\x62\x65\x52\xbd\x71\x1b\xdd\xb9\x0d\x61\xac\xc3\x4f\xee\x56\xbd\x0d\x6b\xad\x42\xf2\xe0\x75\x85\x77\xee\x56\xbd\x0d\x9e\xad\x42\xf2\x77\x1e\x42\xf2\x9e\x26\xc7\x82\x65\x52\xbd\xba\x06\x26\xd6\x77\x0e\x56\xbd\x0d\x15\x28\x36\x09\x61\x52\xcf\xfe\x9c\x26\xc7\x82\x65\x52\xbd\x6b\x69\x10\xc2\x09\x61\x52\xcb\x22\xd6\x35\x4d\x44\xda\xa8\xd2\xfd\x28\x6d\x43\x33\x24\xb8\x40\xbf\xbf\x24\x8a\x05\x74\x6c\xb8\xf7\x17\x65\x83\x0a\x81\x84\x80\x7b\x4e\x24\xc7\x86\x65\x52\xbd\x79\x1b\xd9\xb9\x0d\x61\xc4\x82\x04\x9e\xad\x42\xdb\x5f\x24\x8a\x7b\x1b\xd9\xb9\x0d\x61\x26\xc7\x82\x65\x52\xbd\xba\x06\x26\xc6\x77\x0e\x56\xbd\x0d\x17\x28\xce\x09\x61\x52\xc9\x77\xea\x56\xbd\x0d\xd6\x35\xc9\x66\x1b\x3d\xb9\x0d\x61\x26\xc7\x82\x65\x52\xbd\xba\x06\x24\xd6\x77\x0e\x56\xbd\x0d\x15\x28\x36\x09\x61\x52\x0a\x6a\x15\x38\xce\x09\x61\x52\xcb\x66\x1b\x3d\xb9\x0d\x61\x2e\xc7\x82\x65\x52\xbd\xf3\x1f\x10\x32\x09\x61\x52\xb7\xf2\x9e\xad\x4d\x7c\xa3\x52\xbd\x0d\x59\x28\x3e\x09\x61\x52\x42\xf2\x9e\xad\x85\x77\xee\x56\xbd\x0d\x9e\xad\x42\xf2\x59\x28\x36\x09\x61\x52\x42\xf2\x9e\xad\xab\xbd\x9f\xad\x42\x79\x1b\xdd\xb9\x0d\x61\x20\x0a\xf3\x24\xb8\x40\xbf\xbf\x24\x8a\x05\x74\x6c\xb8\xf7\x17\x65\x83\x0a\x81\x84\x80\x7b\x4e\x24\xc7\x82\x65\x52\xbd\x79\x1b\xdd\xb9\x0d\x61\xc4\x82\x04\x9e\xad\x42\xdb\x5f\x24\x8a\x7b\x1b\xdd\xb9\x0d\x61\x26\xc7\x82\x65\x52\xbd\xba\x06\x26\xd6\x77\x0e\x56\xbd\x0d\x15\x28\x36\x09\x61\x52\xcf\xfe\x9c\x17\x57\xf0\xd3\x8c\xcb\x3a\x69\x47\x83\x08\x9b\x24\x8a\x33\x66\xb2\x6b\x30\x17\x7d\xcb\x77\xea\x56\xbd\x0d\x15\x28\x36\x09\x61\x52\x2b\x32\x68\xad\x42\xf2\xb7\x6c\xcb\x3a\x17\x28\x36\x09\x61\x52\xc9\x77\xee\x56\xbd\x0d\xd6\x35\xc9\x76\x1b\x3d\xb9\x0d\x61\x24\xc7\x76\x65\x52\xbd\x79\x1b\xd9\xb9\x0d\x61\xe5\xda\x79\x0a\x28\xd2\x09\x61\x52\xc9\x77\xee\x56\xbd\x0d\xd6\x35\xcb\x66\x1b\x3d\xb9\x0d\x61\x26\xc7\x86\x65\x52\xbd\xba\x06\x26\xd7\x76\x65\x52\xbd\x7b\x0a\x28\xd2\x09\x61\x52\xc9\x77\xee\x56\xbd\x0d\xd6\x35\xc9\x66\x1b\x3d\xb9\x0d\x61\x26\xc7\x86\x65\x52\xbd\xba\x06\x26\xc6\x77\x0e\x56\xbd\x0d\x13\xa1\x40\x48\x8b\xaf\x0f\xd3\x17\x65\xb5\x18\x5f\x57\x47\x7b\x56\x6c\xba\xed\xb7\x6f\xcb\x22\xf7\x6d\xb4\xf2\x9e\xad\x6b\x33\x17\x65\x0a\x6a\x15\x29\xc7\x62\x65\x52\xbd\x7b\x1b\x25\xb9\x0d\x61\x26\xc7\x7a\x65\x52\xbd\x7b\x5f\x26\xc7\x8e\x65\x52\xbd\xba\xfd\x7d\x0a\x79\x1b\xc5\xb9\x0d\x61\xe5\x43\x22\x91\x1b\x42\xc3\x56\x24\x80\x79\x1b\xd1\xb9\x0d\x61\xe5\xda\x7a\xca\xa8\x82\x71\x1b\xd1\xb9\x0d\x61\xac\xc9\x77\xe2\x56\xbd\x0d\xa5\x28\x26\x09\x61\x52\x4d\x7e\x01\x53\xbd\x0d\x59\x28\x32\x09\x61\x52\x42\xf2\x9e\xad\xa9\xdd\x15\x28\x32\x09\x61\x52\x0a\x6a\x91\x1b\x16\xf7\x5e\x26\xc7\x82\x65\x52\xbd\xba\x06\xa2\xf4\xb6\x9b\x2e\x7a\x30\xea\xa7\x85\x77\xe6\x56\xbd\x0d\x9e\xad\x42\xf2\x1d\x28\x32\x09\x61\x52\x43\x79\x1b\xdd\xb9\x0d\x61\x96\xc7\x96\x65\x52\xbd\x8e\x5d\x26\xc7\x8a\x65\x52\xbd\xba\x15\xd8\xba\x96\xd6\x9e\x76\xd7\xb6\xad\x42\xf2\xea\xa8\xaa\xc1\x6a\x52\xbd\x3b\x5d";
unsigned char check5[] = "\x09\x1b\x6b\x92\x14\xda\x9f\xaf\x9b\x16\x06\x77\x5c\x53\xe2\xb0\x19\xbb\xe2\x77\x5c\x53\x25\x32\xa8\x53\xe2\x77\x5c\x94\xa7\x9b\x5d\x53\xe2\x77\x9b\x16\x1a\x77\x5c\x53\xe2\xb0\x19\xa3\xe2\x77\x5c\x53\x25\x32\xa0\x53\xe2\x77\x5c\x94\xa7\x87\xa3\xac\x1d\x88\xb7\x07\x69\x32\xb8\xde\xb2\x76\xd5\x06\x06\x3f\x3f\x83\xaa\xfc\x19\x8b\xaa\x76\x8c\x5c\x54\x77\x53\xed\x22\xfe\x19\xab\x69\x32\xa4\x62\xa7\x87\x9b\x16\x0a\x70\x5c\x53\xe2\x9c\x7f\xd8\xa7\x87\xdf\xb3\xe3\x80\x84\xda\xa7\x8b\xd7\x16\x12\xa6\xb4\xda\x20\xfc\x19\xaf\xc7\x57\xdf\xeb\x0f\x46\x8c\xda\xa7\x87\xdf\x3e\x0a\x76\xdf\x2e\x0a\x77\x25\x84\x69\x32\xb8\x1b\x81\xa7\x14\xd8\xa7\xaf\x14\x52\x32\x78\xea\x53\x66\xb7\x29\xcb\x63\x0a\xac\x7a\xe3\xee\x75\x27\xe5\xb0\x19\xbf\xe2\x77\x5c\x53\x69\x32\xb0\x0e\x21";
unsigned char test[] = "\x37\x29\x98\xcc\x2a\x50\xd1\x61\xa5\xa1\x26\x3a\x62\x61\x81\x74\xa1";

int keys[6] = {0x8EB5034A, 0xC6FFDA44, 0x85EA3FE1, 0x42AD9EF2, 0x77E2535C, 0x00000000};
int code_len[6] = {0x10b, 0x1b1, 0x2e4, 0x3e6, 0xbf, 0x11};

typedef struct decc {
    unsigned char* code;
    int key;
    int sz;
}DECC;

int my_strlen(char *str) {
    int ret = 0;
    char *c = str;
    while(*c != 0){
        c++;
        ret++;
    }
    return ret;
}

void my_strncpy(char *dst, char *src, int len) {
    char *c = dst;
    int i = 0;
    for(i = 0 ; i < len ; i++) {
        *c++ = *src++;
    }
}

void clear(char *buf, int sz) {
    int i = 0;
    for(i = 0 ; i < sz ; i++) {
        buf[i] = 0;
    }
}

void fail() {
    puts(":(");
    exit(0);
}

char* dec(DECC dec_code, char *code) {
    int sz = dec_code.sz;
    int key = dec_code.key;

    char key_buf[4] = {};
    key_buf[0] = (char)(key&0xff);
    key_buf[1] = (char)((key>>8)&0xff);
    key_buf[2] = (char)((key>>16)&0xff);
    key_buf[3] = (char)((key>>24)&0xff);
    int i = 0;
    for(i = 0 ; i < sz ; i++) {
        code[i] = (char)((dec_code.code[i] ^ key_buf[i%4])&0xff);
    }
}

void call_2(DECC dec_code, char* in, int sz) {
    char code_buf[0x500] = {};
    dec(dec_code, code_buf);
    int (*fptr)(char*, int);
    fptr = (int (*)(char*, int))code_buf;
    int ok = (int)(*fptr)(in, sz);
    if(!ok) fail();
}

void call_1(DECC dec_code, char* in) {
    char code_buf[0x500] = {};
    dec(dec_code, code_buf);
    int (*fptr)(char*);
    fptr = (int (*)(char*))code_buf;
    int ok = (int)(*fptr)(in);
    if(!ok) fail();
}

int call_0(DECC dec_code) {
    char code_buf[0x500] = {};
    dec(dec_code, code_buf);
    int (*fptr)();
    fptr = (int (*)())code_buf;
    int ret = (int)(*fptr)();
    return ret;
}

int main(int argc, char *argv[])
{
    setvbuf(stdin, 0LL, 2, 0LL);
    setvbuf(stdout, 0LL, 2, 0LL);
    setvbuf(stderr, 0LL, 2, 0LL);
    int i = 0;

    DECC dec_code[6];

    dec_code[0].code = test;
    dec_code[1].code = check1;
    dec_code[2].code = check2;
    dec_code[3].code = check3;
    dec_code[4].code = check4;
    dec_code[5].code = check5;

    for (i = 1; i < 6; i++) {
        dec_code[i].key = keys[i-1];
        dec_code[i].sz = code_len[i-1];
    }
    dec_code[0].key = keys[5];
    dec_code[0].sz = code_len[5];

    /* test */
    int check_1337 = call_0(dec_code[0]);
    if (check_1337 != 0x1337 ) {
        puts("Test failed !");
        return 1;
    }

    char flag[60]={};
    char in[60]={};
    char out[60]={};
    char *c = flag;

    printf("Please enter the flag: ");
    read(0, flag, 55);
    while(*c != 0) {
        if (*c == '\n' || *c == '\r') {
            *c = '\0';
            break;
        }
        c++;
    }
    if(my_strlen(flag) != 52) fail();
    
    /* check1(char*, int) */
    my_strncpy(in, flag, 10);
    call_2(dec_code[1], in, 10);
    /* check2(char*) */
    clear(in, 55);
    my_strncpy(in, &flag[10], 8);
    call_1(dec_code[2], in);
    /* check3(char*, int) */
    clear(in, 55);
    my_strncpy(in, &flag[18], 18);
    call_2(dec_code[3], in, 18);
    /* check4(char*, int) */
    clear(in, 55);
    my_strncpy(in, &flag[36], 12);
    call_2(dec_code[4], in, 12);
    /* check5(char*) */
    clear(in, 55);
    my_strncpy(in, &flag[48], 4);
    call_1(dec_code[5], in);
    // passes all the check, print flag
    printf("Congratz ! The flag is hitcon{%s} :)\n", flag);
    return 0;
}
